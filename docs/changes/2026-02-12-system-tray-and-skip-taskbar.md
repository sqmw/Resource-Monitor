# 2026-02-12 改造记录：系统托盘与任务栏图标隐藏

## 目标

1. 增加系统托盘（Tray）作为常驻入口。
2. 不再在系统任务栏显示应用图标（`skipTaskbar`）。

## 实现

### 1) 启用 Tray 能力

- 文件：`src-tauri/Cargo.toml`
- 调整：
  - `tauri` 增加 feature：`tray-icon`

### 2) 托盘菜单与事件

- 文件：`src-tauri/src/lib.rs`
- 新增：
  1. Tray 菜单项：
     - `打开主窗口`
     - `退出`
  2. 左键单击托盘图标：唤起主窗口（恢复最小化 + show + focus）
  3. 托盘菜单行为：
     - `show_main` -> 打开主窗口
     - `quit_app` -> 退出应用

### 3) 隐藏任务栏图标

- 文件：`src-tauri/tauri.conf.json`
- 调整：
  - 主窗口增加 `"skipTaskbar": true`

## 结果

1. 应用有系统托盘入口。
2. 主窗口不再占用任务栏图标位。

## 任务栏定位模式（Tray 控制）

新增托盘菜单项：`切换任务栏定位模式`。

1. 开启后：
   - 任务栏条允许鼠标拖动定位
   - 支持键盘方向键微调位置
   - 长按方向键速度更快，按住 `Shift` 加速更明显
   - 强制保持窗口置顶，避免拖动时被其他窗口遮挡
2. 关闭后：
   - 任务栏条恢复贴边定位策略
3. 定位结果会持久化，重启后恢复。

## 交互文案优化

定位菜单文案改为状态化，避免歧义：

1. 默认：`启动拖动模式`
2. 开启后：`退出拖动模式`
